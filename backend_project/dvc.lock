schema: '2.0'
stages:
  data_collection:
    cmd: python manage.py fetch_training_data
    deps:
    - path: apps/core/management/commands/fetch_training_data.py
      hash: md5
      md5: 7f0f54239f66e156e4d3abbac6fcb8ce
      size: 590
    - path: apps/core/retraining/data_collection.py
      hash: md5
      md5: b92fc9990ab8156bb9673c510013c493
      size: 2477
    outs:
    - path: media/raw
      hash: md5
      md5: 192c45b5c7f58a28eb7c05d82315c70b.dir
      size: 179269
      nfiles: 1
  data_formatting:
    cmd: python manage.py format_training_data
    deps:
    - path: apps/core/management/commands/format_training_data.py
      hash: md5
      md5: 332d29d4ac815912a3086f935ac4fb72
      size: 595
    - path: apps/core/retraining/data_formatting.py
      hash: md5
      md5: 3221ab10006e4c416acd1b51e0502b69
      size: 6190
    - path: media/raw
      hash: md5
      md5: 4498cff5c96a4c246ff02a96e37789ff.dir
      size: 40426
      nfiles: 1
    outs:
    - path: media/images
      hash: md5
      md5: 895274e7257d8029e77a09a1169df8c6.dir
      size: 144424192
      nfiles: 20
    - path: media/labels
      hash: md5
      md5: f19f1e2101ac4c7fb1780a085f15d7f2.dir
      size: 11848
      nfiles: 22
  model_training:
    cmd: python manage.py train_model
    deps:
    - path: apps/core/management/commands/train_model.py
      hash: md5
      md5: 5597a746476df2a252ddd0e767c4bf7e
      size: 709
    - path: apps/core/retraining/retraining.py
      hash: md5
      md5: 65b97d064b3bcb7ae5704f81215288f4
      size: 9447
    - path: media/dataset.yaml
      hash: md5
      md5: 1536935dd27e788f29f03efb87f36029
      size: 216
    - path: media/images
      hash: md5
      md5: 895274e7257d8029e77a09a1169df8c6.dir
      size: 144424192
      nfiles: 20
    - path: media/labels
      hash: md5
      md5: 4dc103e9aeec054b9082e38b06149c4c.dir
      size: 13967
      nfiles: 22
    outs:
    - path: media/runs/train
      hash: md5
      md5: f952353167c820eea74919902a1be6ad.dir
      size: 32316899
      nfiles: 18
  first_reviewer_data_collection:
    cmd: python manage.py fetch_first_reviewer_data
    deps:
    - path: apps/core/management/commands/fetch_first_reviewer_data.py
      hash: md5
      md5: 9fde79e7709ba8799b62830a75d8caa8
      size: 674
    - path: apps/core/retraining/data_collection_first_reviewer.py
      hash: md5
      md5: 6082d013a3b2303f2bc54b6817b406bf
      size: 2596
    outs:
    - path: media/raw_first_reviewer
      hash: md5
      md5: 8589a2edd51b51e35341c8c83829d172.dir
      size: 185537
      nfiles: 1
  first_reviewer_data_formatting:
    cmd: python manage.py format_first_reviewer_data
    deps:
    - path: apps/core/management/commands/format_first_reviewer_data.py
      hash: md5
      md5: d3ea0f4b224957c7bd7d18e8af7ffa1d
      size: 685
    - path: apps/core/retraining/data_formatting_first_reviewer.py
      hash: md5
      md5: 6f0eed2c680c3139e63aa28002f16ca5
      size: 6535
    - path: media/raw_first_reviewer
      hash: md5
      md5: 77d1a22f6da38655638d57c71898cc1a.dir
      size: 9531
      nfiles: 1
    outs:
    - path: media/images_first_reviewer
      hash: md5
      md5: 331fdf36b2d2474044b6dd46db957d31.dir
      size: 28492287
      nfiles: 4
    - path: media/labels_first_reviewer
      hash: md5
      md5: 3e8468624cfda5f1b2615f8e0ba3a43f.dir
      size: 1174
      nfiles: 4
  first_reviewer_model_training:
    cmd: python manage.py train_first_reviewer_model
    deps:
    - path: apps/core/management/commands/train_first_reviewer_model.py
      hash: md5
      md5: c0400232819e4a80f2830037d66fb296
      size: 784
    - path: apps/core/retraining/retraining_first_reviewer.py
      hash: md5
      md5: fd956f72d981b8a0fc7160e3d7e51c1f
      size: 9619
    - path: media/dataset.yaml
      hash: md5
      md5: 1536935dd27e788f29f03efb87f36029
      size: 216
    - path: media/images_first_reviewer
      hash: md5
      md5: 331fdf36b2d2474044b6dd46db957d31.dir
      size: 28492287
      nfiles: 4
    - path: media/labels_first_reviewer
      hash: md5
      md5: 3e8468624cfda5f1b2615f8e0ba3a43f.dir
      size: 1174
      nfiles: 4
    outs:
    - path: media/runs/train_first_reviewer
      hash: md5
      md5: 49f185ffcfea862e6a344531a526d65b.dir
      size: 32317339
      nfiles: 18
  kfold_data_formatting:
    cmd: python manage.py format_training_data_kfold --k=7
    deps:
    - path: apps/core/management/commands/format_training_data_kfold.py
      hash: md5
      md5: 687e903f32e9e3ccf7878ba8e2dfc419
      size: 920
    - path: apps/core/retraining/data_formatting.py
      hash: md5
      md5: 223fbade283411b51492ad40bde01cf1
      size: 14409
    - path: media/raw
      hash: md5
      md5: 192c45b5c7f58a28eb7c05d82315c70b.dir
      size: 179269
      nfiles: 1
    outs:
    - path: media/kfolds
      hash: md5
      md5: d7175b7d86ba0523ec8c6d55c77e9d80.dir
      size: 3123487185
      nfiles: 927
  kfold_model_training:
    cmd: "python manage.py train_model_kfold  --k=7  --epochs=20  --batch-size=4 --img-size=640
      --patience=5\n"
    deps:
    - path: apps/core/management/commands/train_model_kfold.py
      hash: md5
      md5: d796b6029668efe86e5c5ba90d7ebe7c
      size: 2540
    - path: apps/core/retraining/retraining.py
      hash: md5
      md5: cf8eec8b7f44d13351167b707e8ee066
      size: 21144
    - path: media/kfolds
      hash: md5
      md5: 0a7fcfaa37b542268a6c37c9b675b519.dir
      size: 3123627846
      nfiles: 941
    outs:
    - path: media/runs/kfold
      hash: md5
      md5: 818184f88500bd3480e3f5a7555a8ae0.dir
      size: 220709478
      nfiles: 139
  first_reviewer_kfold_data_formatting:
    cmd: python manage.py format_first_reviewer_data_kfold --k=7
    deps:
    - path: apps/core/management/commands/format_first_reviewer_data_kfold.py
      hash: md5
      md5: 37b9c98ec9e9620ede85b972e878954f
      size: 1024
    - path: apps/core/retraining/data_formatting_first_reviewer.py
      hash: md5
      md5: b3b904f8074c3890826646f6e6bd6051
      size: 14615
    - path: media/raw_first_reviewer
      hash: md5
      md5: 8589a2edd51b51e35341c8c83829d172.dir
      size: 185537
      nfiles: 1
    outs:
    - path: media/kfolds_first_reviewer
      hash: md5
      md5: 3b42139fe34cb58578b875896bd76d8b.dir
      size: 3224088065
      nfiles: 953
  first_reviewer_kfold_model_training:
    cmd: "python manage.py train_first_reviewer_model_kfold  --k=7  --epochs=20  --batch-size=4\
      \  --img-size=640 --patience=5\n"
    deps:
    - path: apps/core/management/commands/train_first_reviewer_model_kfold.py
      hash: md5
      md5: b72cc04343a1c79a50aa5225a419d4a1
      size: 2653
    - path: apps/core/retraining/retraining_first_reviewer.py
      hash: md5
      md5: 97bade1f1d769f9cff8a7c32e347acbd
      size: 21029
    - path: media/kfolds_first_reviewer
      hash: md5
      md5: 398c1f25aa25c997f1b4ad120d55db0e.dir
      size: 3224241103
      nfiles: 967
    outs:
    - path: media/runs/kfold_first_reviewer
      hash: md5
      md5: 8dd9de57bc71a03b3f82757c326afd91.dir
      size: 221090386
      nfiles: 141
